# Quick Start for Telegram Alerts

## What You Need to Do

### 1. Setup Environment Variables
```bash
cd infrastructure/monitoring
cp env.template .env
```

### 2. Generate Authentication Hashes
```bash
# Simple generation
./generate-auth.sh your_secure_password

# Or custom generation
./generate-custom-auth.sh your_secure_password metrics_user admin_user
```

### 3. Edit .env File
```bash
nano .env
# Add your values
```

### 4. Restart Monitoring
```bash
make restart
```

### 5. Check Status
```bash
make status
```

### 6. Check Accessibility
- Prometheus: `https://your-domain.com/prometheus/`
- Grafana: `https://your-domain.com/grafana/`
- Alertmanager: `https://your-domain.com/alertmanager/`

## What Will Work

### Telegram Alerts
- **Single recipient**: all notifications come only to you
- **Critical**: repeat every 30 minutes
- **Warnings**: repeat every 2 hours
- **Regular**: repeat every hour

### Alert Types
- ServiceDown (critical)
- HighErrorRate (warning)
- SlowResponseTime (warning)
- HighMemoryUsage (warning)
- HighCPUUsage (warning)
- HighGoroutineCount (warning)
- HighAPIErrorRate (warning)
- HighWebhookFailureRate (warning)
- HighRateLimitHitRate (warning)
- HighFailureRate (warning)

## Settings

### Environment Variables in .env File
- `TELEGRAM_BOT_TOKEN` - your Telegram bot token
- `TELEGRAM_CHAT_ID` - chat ID for notifications
- `DOMAIN` - your domain
- `METRICS_AUTH_HASH` - hash for metrics authentication (generated by script)
- `GRAFANA_AUTH_HASH` - hash for Grafana authentication (generated by script)
- `GRAFANA_ADMIN_PASSWORD` - Grafana administrator password

### Alert Thresholds
- Errors: > 0.1 per second
- Memory: > 500MB
- CPU: > 80%
- Goroutines: > 1000
- Response time: > 1 second

## Troubleshooting

### If alerts don't arrive
1. Check logs: `make logs`
2. Make sure bot is added to chat
3. Check chat ID correctness

### If services don't start
1. Check logs: `make logs`
2. Make sure ports are free
3. Check file permissions

## Testing

### Create test alert
In `alert_rules.yml` add:
```yaml
- alert: TestAlert
  expr: vector(1)
  for: 0m
  labels:
    severity: warning
  annotations:
    summary: "Test alert"
    description: "This is a test alert"
```

### Check in Prometheus
1. Open Prometheus
2. Go to "Alerts"
3. Find "TestAlert"
4. Alert should appear and notification should be sent to Telegram